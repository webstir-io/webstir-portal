"use strict";(self.webpackChunkwebstir_portal=self.webpackChunkwebstir_portal||[]).push([[6402],{8448:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"how-to/watch","title":"Watch","description":"Run an initial build and tests, start dev servers, and react to changes with targeted rebuilds and live reload.","source":"@site/docs/how-to/watch.md","sourceDirName":"how-to","slug":"/how-to/watch","permalink":"/docs/how-to/watch","draft":false,"unlisted":false,"editUrl":"https://github.com/webstir-io/webstir-portal/edit/main/docs/how-to/watch.md","tags":[],"version":"current","lastUpdatedAt":1762915999000,"frontMatter":{},"sidebar":"howTo","previous":{"title":"Vite Frontend Provider","permalink":"/docs/how-to/vite-provider-pilot"}}');var i=s(4848),d=s(8453);const l={},t="Watch",c={},o=[{value:"Purpose",id:"purpose",level:2},{value:"When To Use",id:"when-to-use",level:2},{value:"CLI",id:"cli",level:2},{value:"Runtime Scope",id:"runtime-scope",level:2},{value:"Steps",id:"steps",level:2},{value:"Readiness &amp; Health",id:"readiness--health",level:2},{value:"Outputs",id:"outputs",level:2},{value:"Stop &amp; Recovery",id:"stop--recovery",level:2},{value:"Errors &amp; Exit Codes",id:"errors--exit-codes",level:2},{value:"Related Docs",id:"related-docs",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"watch",children:"Watch"})}),"\n",(0,i.jsx)(n.p,{children:"Run an initial build and tests, start dev servers, and react to changes with targeted rebuilds and live reload."}),"\n",(0,i.jsx)(n.h2,{id:"purpose",children:"Purpose"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Fast feedback loop during development."}),"\n",(0,i.jsx)(n.li,{children:"Keep dev server and API in sync with file changes."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"when-to-use",children:"When To Use"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Default local workflow while editing."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"cli",children:"CLI"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"webstir watch [--runtime <frontend|backend|all>]"})," (also the default command when none is provided)"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"runtime-scope",children:"Runtime Scope"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The CLI inspects ",(0,i.jsx)(n.code,{children:"src/frontend"})," / ",(0,i.jsx)(n.code,{children:"src/backend"})," and runs the workers it finds."]}),"\n",(0,i.jsxs)(n.li,{children:["Override the automatic scope with ",(0,i.jsx)(n.code,{children:"--runtime frontend"}),", ",(0,i.jsx)(n.code,{children:"--runtime backend"}),", or ",(0,i.jsx)(n.code,{children:"--runtime all"})," (alias ",(0,i.jsx)(n.code,{children:"-r"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["The watch logs now print a one-line summary (",(0,i.jsx)(n.code,{children:"[watch] Runtime scope \u2014 workspace: frontend+backend, filter: backend, running: backend-only"}),") so you can confirm the active mode."]}),"\n",(0,i.jsxs)(n.li,{children:["Environment toggle: ",(0,i.jsx)(n.code,{children:"WEBSTIR_TEST_RUNTIME=<scope>"})," has the same effect and forwards to the test runner."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Examples:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"webstir watch --runtime backend"})," \u2014 skip frontend rebuilds/reloads when you\u2019re iterating on APIs or jobs."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WEBSTIR_TEST_RUNTIME=frontend webstir watch"})," \u2014 force frontend-only loops even if ",(0,i.jsx)(n.code,{children:"src/backend"})," exists."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"steps",children:"Steps"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Run ",(0,i.jsx)(n.code,{children:"build"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Run ",(0,i.jsx)(n.code,{children:"test"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Start the dev web server (serves ",(0,i.jsx)(n.code,{children:"build/frontend/**"}),", SSE reload, clean URLs)."]}),"\n",(0,i.jsxs)(n.li,{children:["Start the Node API server from ",(0,i.jsx)(n.code,{children:"build/backend/index.js"})," and configure the proxy at ",(0,i.jsx)(n.code,{children:"/api/*"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Start watching ",(0,i.jsx)(n.code,{children:"src/**"}),"; ignore ",(0,i.jsx)(n.code,{children:"build/**"})," and ",(0,i.jsx)(n.code,{children:"dist/**"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Route changes:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Frontend change \u2192 frontend pipelines \u2192 write to ",(0,i.jsx)(n.code,{children:"build/frontend/**"})," \u2192 broadcast SSE reload."]}),"\n",(0,i.jsx)(n.li,{children:"Backend change \u2192 backend compile \u2192 restart Node process."}),"\n",(0,i.jsx)(n.li,{children:"Shared change \u2192 rebuild affected frontend and backend targets."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"readiness--health",children:"Readiness & Health"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The Node API server prints ",(0,i.jsx)(n.code,{children:"API server running"})," on successful bind. The orchestrator waits for this readiness line and then probes ",(0,i.jsx)(n.code,{children:"/api/health"})," (alias ",(0,i.jsx)(n.code,{children:"/healthz"}),") before declaring the backend ready. A dedicated ",(0,i.jsx)(n.code,{children:"/readyz"})," endpoint is also available if you need an external readiness check that echoes the manifest summary."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Toggles (environment variables):"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WEBSTIR_BACKEND_WAIT_FOR_READY=skip"})," \u2014 skip waiting for the log\u2011based ready signal."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WEBSTIR_BACKEND_READY_TIMEOUT_SECONDS"})," \u2014 readiness wait timeout (default 30)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WEBSTIR_BACKEND_HEALTHCHECK=skip"})," \u2014 skip the health probe."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WEBSTIR_BACKEND_HEALTH_TIMEOUT_SECONDS"})," \u2014 per\u2011attempt probe timeout (default 5)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WEBSTIR_BACKEND_HEALTH_ATTEMPTS"})," \u2014 number of retries before failing (default 5)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WEBSTIR_BACKEND_HEALTH_DELAY_MILLISECONDS"})," \u2014 delay between retries (default 250)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WEBSTIR_BACKEND_HEALTH_PATH"})," \u2014 override the probe path (default ",(0,i.jsx)(n.code,{children:"/api/health"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WEBSTIR_BACKEND_TERMINATION"})," \u2014 Node shutdown method during watch (",(0,i.jsx)(n.code,{children:"ctrlc"})," or ",(0,i.jsx)(n.code,{children:"kill"}),"; default ",(0,i.jsx)(n.code,{children:"kill"}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Examples:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Skip both waits in a pinch:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"WEBSTIR_BACKEND_WAIT_FOR_READY=skip WEBSTIR_BACKEND_HEALTHCHECK=skip webstir watch"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Increase readiness timeout and health attempts:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"WEBSTIR_BACKEND_READY_TIMEOUT_SECONDS=60 WEBSTIR_BACKEND_HEALTH_ATTEMPTS=10 webstir watch"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"outputs",children:"Outputs"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Live dev server URL printed on startup."}),"\n",(0,i.jsxs)(n.li,{children:["Incremental updates to ",(0,i.jsx)(n.code,{children:"build/**"})," as files change."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"stop--recovery",children:"Stop & Recovery"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Stop with Ctrl+C; services shut down gracefully."}),"\n",(0,i.jsx)(n.li,{children:"Persistent backend errors are throttled to avoid restart loops; errors are logged."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"errors--exit-codes",children:"Errors & Exit Codes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Startup failures return non-zero (build/test/backend bind errors). Runtime errors are logged."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"related-docs",children:"Related Docs"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Workflows \u2014 ",(0,i.jsx)(n.a,{href:"/docs/reference/workflows",children:"workflows"})]}),"\n",(0,i.jsxs)(n.li,{children:["Services \u2014 ",(0,i.jsx)(n.a,{href:"/docs/explanations/services",children:"services"})]}),"\n",(0,i.jsxs)(n.li,{children:["Servers \u2014 ",(0,i.jsx)(n.a,{href:"/docs/explanations/servers",children:"servers"})]}),"\n",(0,i.jsxs)(n.li,{children:["Engine \u2014 ",(0,i.jsx)(n.a,{href:"/docs/explanations/engine",children:"engine"})]}),"\n",(0,i.jsxs)(n.li,{children:["Workspace \u2014 ",(0,i.jsx)(n.a,{href:"/docs/explanations/workspace",children:"workspace"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>t});var r=s(6540);const i={},d=r.createContext(i);function l(e){const n=r.useContext(d);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(d.Provider,{value:n},e.children)}}}]);