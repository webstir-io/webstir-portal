"use strict";(self.webpackChunkwebstir_portal=self.webpackChunkwebstir_portal||[]).push([[8238],{8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>t});var i=s(6540);const r={},d=i.createContext(r);function c(e){const n=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(d.Provider,{value:n},e.children)}},9304:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"reference/cli","title":"CLI","description":"Detailed reference for the webstir CLI. This expands the high-level overview in solution.md and focuses on concrete behavior, options, and outputs.","source":"@site/docs/reference/cli.md","sourceDirName":"reference","slug":"/reference/cli","permalink":"/docs/reference/cli","draft":false,"unlisted":false,"editUrl":"https://github.com/webstir-io/webstir-portal/edit/main/docs/reference/cli.md","tags":[],"version":"current","lastUpdatedAt":1764454564000,"frontMatter":{},"sidebar":"reference","previous":{"title":"Reference","permalink":"/docs/reference/"},"next":{"title":"Contracts & Invariants","permalink":"/docs/reference/contracts"}}');var r=s(4848),d=s(8453);const c={},t="CLI",l={},o=[{value:"Overview",id:"overview",level:2},{value:"Usage",id:"usage",level:2},{value:"Commands",id:"commands",level:2},{value:"init",id:"init",level:3},{value:"build",id:"build",level:3},{value:"watch (default)",id:"watch-default",level:3},{value:"test",id:"test",level:3},{value:"install",id:"install",level:3},{value:"publish",id:"publish",level:3},{value:"backend-inspect",id:"backend-inspect",level:3},{value:"add-page",id:"add-page",level:3},{value:"add-test",id:"add-test",level:3},{value:"add-route",id:"add-route",level:3},{value:"add-job",id:"add-job",level:3},{value:"smoke",id:"smoke",level:3},{value:"Dev Server &amp; Watch",id:"dev-server--watch",level:2},{value:"Build &amp; Publish Pipelines",id:"build--publish-pipelines",level:2},{value:"Project Layout",id:"project-layout",level:2},{value:"Examples",id:"examples",level:2},{value:"Help Output (Sample)",id:"help-output-sample",level:2},{value:"Exit Codes",id:"exit-codes",level:2},{value:"Contributing Notes",id:"contributing-notes",level:2},{value:"Related Docs",id:"related-docs",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"cli",children:"CLI"})}),"\n",(0,r.jsxs)(n.p,{children:["Detailed reference for the ",(0,r.jsx)(n.code,{children:"webstir"})," CLI. This expands the high-level overview in ",(0,r.jsx)(n.a,{href:"/docs/explanations/solution",children:"solution.md"})," and focuses on concrete behavior, options, and outputs."]}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Single entrypoint: ",(0,r.jsx)(n.code,{children:"webstir <command> [options]"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Default command is ",(0,r.jsx)(n.code,{children:"watch"})," when no command is provided."]}),"\n",(0,r.jsxs)(n.li,{children:["Works from the project root created by ",(0,r.jsx)(n.code,{children:"init"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Orchestrates builds, the dev web server, the Node API server, and generators."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"webstir <command> [options]\nwebstir help [command]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Common patterns:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"webstir init my-app"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"webstir init --client-only my-client"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"webstir build --clean"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"webstir watch"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"webstir test"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"webstir install"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"webstir publish"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"webstir add-page about"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"webstir add-test auth/login"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"webstir add-route users"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"webstir add-job cleanup"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"webstir backend-inspect"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"webstir smoke"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"commands",children:"Commands"}),"\n",(0,r.jsx)(n.h3,{id:"init",children:"init"}),"\n",(0,r.jsxs)(n.p,{children:["Usage: ",(0,r.jsx)(n.code,{children:"webstir init [--client-only|--server-only] [--project-name|-p <name>] [directory]"})]}),"\n",(0,r.jsx)(n.p,{children:"What it does:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Creates a new project from embedded templates (frontend, backend, shared, and types)."}),"\n",(0,r.jsxs)(n.li,{children:["Layout includes ",(0,r.jsx)(n.code,{children:"src/frontend/app"}),", ",(0,r.jsx)(n.code,{children:"src/frontend/pages/<page>"}),", ",(0,r.jsx)(n.code,{children:"src/backend"}),", ",(0,r.jsx)(n.code,{children:"src/shared"}),", and ",(0,r.jsx)(n.code,{children:"types/"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Initializes a working dev setup that builds and runs with ",(0,r.jsx)(n.code,{children:"webstir watch"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Notes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Choose one of ",(0,r.jsx)(n.code,{children:"--client-only"})," or ",(0,r.jsx)(n.code,{children:"--server-only"})," to limit what is scaffolded."]}),"\n",(0,r.jsx)(n.li,{children:"Without options, generates a full-stack project."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"build",children:"build"}),"\n",(0,r.jsxs)(n.p,{children:["Usage: ",(0,r.jsx)(n.code,{children:"webstir build [--clean]"})]}),"\n",(0,r.jsx)(n.p,{children:"What it does:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Compiles TypeScript via ",(0,r.jsx)(n.code,{children:"tsc --build"})," using the embedded base config."]}),"\n",(0,r.jsx)(n.li,{children:"Processes CSS imports; copies app assets."}),"\n",(0,r.jsxs)(n.li,{children:["Merges page HTML fragments with ",(0,r.jsx)(n.code,{children:"src/frontend/app/app.html"})," and writes to ",(0,r.jsx)(n.code,{children:"build/frontend/"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Compiles backend code to ",(0,r.jsx)(n.code,{children:"build/backend/"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Notes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--clean"})," removes previous ",(0,r.jsx)(n.code,{children:"build/"})," before compiling."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--runtime <frontend|backend|all>"})," (or ",(0,r.jsx)(n.code,{children:"-r"}),") runs only the selected workers. By default the CLI inspects ",(0,r.jsx)(n.code,{children:"src/frontend"})," / ",(0,r.jsx)(n.code,{children:"src/backend"})," and builds everything that exists."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"watch-default",children:"watch (default)"}),"\n",(0,r.jsxs)(n.p,{children:["Usage: ",(0,r.jsx)(n.code,{children:"webstir watch"})]}),"\n",(0,r.jsx)(n.p,{children:"What it does:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Runs an initial ",(0,r.jsx)(n.code,{children:"build"})," and ",(0,r.jsx)(n.code,{children:"test"})," (delegating test execution to the Webstir test host)."]}),"\n",(0,r.jsxs)(n.li,{children:["Starts the dev web server (serves ",(0,r.jsx)(n.code,{children:"build/frontend/**"}),") and the Node API server (runs ",(0,r.jsx)(n.code,{children:"build/backend/index.js"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Watches ",(0,r.jsx)(n.code,{children:"src/**"})," for changes and performs targeted, incremental rebuilds."]}),"\n",(0,r.jsx)(n.li,{children:"Restarts the Node server on backend changes; notifies browsers via SSE to reload on frontend changes."}),"\n",(0,r.jsxs)(n.li,{children:["Stops early with an actionable message if framework packages drift, pointing to ",(0,r.jsx)(n.code,{children:"webstir install"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Node server readiness and health"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Waits for the ",(0,r.jsx)(n.code,{children:"API server running"})," line on startup and then probes ",(0,r.jsx)(n.code,{children:"/api/health"})," before declaring ready."]}),"\n",(0,r.jsxs)(n.li,{children:["Tuning flags (environment variables):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"WEBSTIR_BACKEND_WAIT_FOR_READY=skip"})," \u2014 skip waiting for the readiness log line"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"WEBSTIR_BACKEND_READY_TIMEOUT_SECONDS"})," \u2014 readiness wait timeout (default 30)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"WEBSTIR_BACKEND_HEALTHCHECK=skip"})," \u2014 skip the health probe entirely"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"WEBSTIR_BACKEND_HEALTH_TIMEOUT_SECONDS"})," \u2014 per-attempt probe timeout (default 5)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"WEBSTIR_BACKEND_HEALTH_ATTEMPTS"})," \u2014 retries before failing (default 5)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"WEBSTIR_BACKEND_HEALTH_DELAY_MILLISECONDS"})," \u2014 delay between retries (default 250)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"WEBSTIR_BACKEND_HEALTH_PATH"})," \u2014 override the probe path (default ",(0,r.jsx)(n.code,{children:"/api/health"}),")"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Automatically detects whether frontend and/or backend directories exist and only enables the relevant workers. Override with ",(0,r.jsx)(n.code,{children:"--runtime <frontend|backend|all>"})," or ",(0,r.jsx)(n.code,{children:"WEBSTIR_TEST_RUNTIME"})," when you need to force a mode (e.g., backend-only loops in a full-stack workspace)."]}),"\n",(0,r.jsxs)(n.li,{children:["Pass ",(0,r.jsx)(n.code,{children:"--runtime <frontend|backend|all>"})," (or ",(0,r.jsx)(n.code,{children:"-r"}),") to limit the tests triggered during watch to a single runtime. The CLI forwards the same value via ",(0,r.jsx)(n.code,{children:"WEBSTIR_TEST_RUNTIME"}),", so scripting the behavior is as simple as ",(0,r.jsx)(n.code,{children:"WEBSTIR_TEST_RUNTIME=backend webstir watch"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"test",children:"test"}),"\n",(0,r.jsxs)(n.p,{children:["Usage: ",(0,r.jsx)(n.code,{children:"webstir test"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Builds the project, ensures the configured test provider is installed (defaults to ",(0,r.jsx)(n.code,{children:"@webstir-io/webstir-testing"}),", overridable via ",(0,r.jsx)(n.code,{children:"WEBSTIR_TESTING_PROVIDER"})," or ",(0,r.jsx)(n.code,{children:"webstir.providers.json"}),"), then invokes the Webstir test host."]}),"\n",(0,r.jsx)(n.li,{children:"Executes compiled frontend and backend tests, emitting structured events the .NET bridge relays."}),"\n",(0,r.jsx)(n.li,{children:"Prints a pass/fail summary; integrates with CI using standard exit codes."}),"\n",(0,r.jsxs)(n.li,{children:["Fails fast if recorded package versions drift and directs you to ",(0,r.jsx)(n.code,{children:"webstir install"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Automatically skips frontend or backend phases when the workspace lacks those directories. Use ",(0,r.jsx)(n.code,{children:"--runtime <frontend|backend|all>"})," (or ",(0,r.jsx)(n.code,{children:"-r"}),") / ",(0,r.jsx)(n.code,{children:"WEBSTIR_TEST_RUNTIME"})," to force a specific scope."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Notes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Override the provider with ",(0,r.jsx)(n.code,{children:"WEBSTIR_TESTING_PROVIDER=<package>"}),"; set ",(0,r.jsx)(n.code,{children:"WEBSTIR_TESTING_PROVIDER_SPEC"})," if you are testing an unpublished build or local checkout."]}),"\n",(0,r.jsxs)(n.li,{children:["Add or edit ",(0,r.jsx)(n.code,{children:"webstir.providers.json"})," in the workspace root to persist provider choices alongside your code."]}),"\n",(0,r.jsx)(n.li,{children:"Provider overrides apply across the manifest run; mixed providers per module are not supported."}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"--runtime <frontend|backend|all>"})," (or ",(0,r.jsx)(n.code,{children:"-r"}),") to override the automatic detection. The same behavior is available via ",(0,r.jsx)(n.code,{children:"WEBSTIR_TEST_RUNTIME=<value>"})," if you need to script it."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"install",children:"install"}),"\n",(0,r.jsxs)(n.p,{children:["Usage: ",(0,r.jsx)(n.code,{children:"webstir install [--dry-run|--clean] [--package-manager <npm|pnpm|yarn[@version]>]"})]}),"\n",(0,r.jsx)(n.p,{children:"What it does:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Ensures the pinned ",(0,r.jsx)(n.code,{children:"@webstir-io/webstir-frontend"}),", ",(0,r.jsx)(n.code,{children:"@webstir-io/webstir-testing"}),", and ",(0,r.jsx)(n.code,{children:"@webstir-io/webstir-backend"})," packages recorded in ",(0,r.jsx)(n.code,{children:"framework-packages.json"})," are installed from the registry and present in ",(0,r.jsx)(n.code,{children:"node_modules"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Updates the workspace ",(0,r.jsx)(n.code,{children:"package.json"})," entries to align with ",(0,r.jsx)(n.code,{children:"framework-packages.json"}),", installs providers referenced in ",(0,r.jsx)(n.code,{children:"webstir.providers.json"}),", and runs the selected package manager when drift is detected."]}),"\n",(0,r.jsx)(n.li,{children:"Verifies installed versions against the embedded manifest and exits with guidance if mismatches remain."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Notes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Run after upgrading the CLI or whenever your package manager has modified pinned dependencies."}),"\n",(0,r.jsx)(n.li,{children:"Safe to run repeatedly; skips work when packages are already in sync."}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"--dry-run"})," to preview which packages would be installed or updated without running a package install (non-zero exit code means action is required)."]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"--clean"})," to remove the cached ",(0,r.jsx)(n.code,{children:".webstir/"})," workspace directory before reinstalling (cannot be combined with ",(0,r.jsx)(n.code,{children:"--dry-run"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Override the tool for a single run with ",(0,r.jsx)(n.code,{children:"--package-manager pnpm@8"})," (or ",(0,r.jsx)(n.code,{children:"-m pnpm@8"}),"); omit ",(0,r.jsx)(n.code,{children:"@version"})," to use the default Corepack-discovered binary."]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.code,{children:"WEBSTIR_PACKAGE_MANAGER=pnpm@8 webstir install"})," to persist the override for the current process; leave unset to fall back on ",(0,r.jsx)(n.code,{children:"package.json"})," metadata or lockfiles."]}),"\n",(0,r.jsxs)(n.li,{children:["Ensure ",(0,r.jsx)(n.code,{children:".npmrc"})," is configured with credentials (for GitHub Packages, export ",(0,r.jsx)(n.code,{children:"GH_PACKAGES_TOKEN"}),") so registry installs succeed."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"publish",children:"publish"}),"\n",(0,r.jsxs)(n.p,{children:["Usage: ",(0,r.jsx)(n.code,{children:"webstir publish"})]}),"\n",(0,r.jsx)(n.p,{children:"What it does:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Produces optimized assets in ",(0,r.jsx)(n.code,{children:"dist/"})," for each page."]}),"\n",(0,r.jsxs)(n.li,{children:["Rewrites HTML to reference fingerprinted assets and emits a per-page ",(0,r.jsx)(n.code,{children:"manifest.json"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Minifies HTML/CSS/JS and removes comments and source maps."}),"\n",(0,r.jsxs)(n.li,{children:["Honors ",(0,r.jsx)(n.code,{children:"--runtime <frontend|backend|all>"})," (or ",(0,r.jsx)(n.code,{children:"-r"}),") so you can publish just the backend artifacts when frontend assets are unchanged."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"backend-inspect",children:"backend-inspect"}),"\n",(0,r.jsxs)(n.p,{children:["Usage: ",(0,r.jsx)(n.code,{children:"webstir backend-inspect [project] [--project-name <name>]"})]}),"\n",(0,r.jsx)(n.p,{children:"What it does:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Runs the backend worker (server-only) to refresh ",(0,r.jsx)(n.code,{children:".webstir/backend-manifest.json"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Prints module metadata (contract version, capabilities, routes, jobs) so you can confirm manifest hydration without starting ",(0,r.jsx)(n.code,{children:"watch"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Notes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Accepts the positional ",(0,r.jsx)(n.code,{children:"[project]"})," or ",(0,r.jsx)(n.code,{children:"--project-name"})," flag when multiple projects exist in the current directory."]}),"\n",(0,r.jsxs)(n.li,{children:["Skips frontend work entirely; run ",(0,r.jsx)(n.code,{children:"webstir build --runtime backend"})," first if you only want to inspect the last build output without rebuilding."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"add-page",children:"add-page"}),"\n",(0,r.jsxs)(n.p,{children:["Usage: ",(0,r.jsx)(n.code,{children:"webstir add-page <name>"})]}),"\n",(0,r.jsx)(n.p,{children:"What it does:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Scaffolds ",(0,r.jsx)(n.code,{children:"index.html"}),", ",(0,r.jsx)(n.code,{children:"index.css"}),", and ",(0,r.jsx)(n.code,{children:"index.ts"})," in ",(0,r.jsx)(n.code,{children:"src/frontend/pages/<name>/"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Ready to build and serve without extra configuration."}),"\n",(0,r.jsxs)(n.li,{children:["Delegates to the ",(0,r.jsx)(n.code,{children:"@webstir-io/webstir-frontend"})," CLI so the scaffold matches the current framework templates."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"add-test",children:"add-test"}),"\n",(0,r.jsxs)(n.p,{children:["Usage: ",(0,r.jsx)(n.code,{children:"webstir add-test <name-or-path>"})]}),"\n",(0,r.jsx)(n.p,{children:"What it does:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Creates a ",(0,r.jsx)(n.code,{children:".test.ts"})," file under the nearest ",(0,r.jsx)(n.code,{children:"tests/"})," folder relative to the path provided."]}),"\n",(0,r.jsx)(n.li,{children:"Works for both frontend and backend test locations."}),"\n",(0,r.jsxs)(n.li,{children:["Uses the ",(0,r.jsx)(n.code,{children:"@webstir-io/webstir-testing"})," CLI to write the template and keep dependencies pinned."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"add-route",children:"add-route"}),"\n",(0,r.jsxs)(n.p,{children:["Usage: ",(0,r.jsx)(n.code,{children:"webstir add-route <name> [--method <METHOD>] [--path <path>] [--fastify] [--project-name <project>]"})]}),"\n",(0,r.jsx)(n.p,{children:"What it does:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Adds a backend route entry to ",(0,r.jsx)(n.code,{children:"webstir.module.routes"})," in ",(0,r.jsx)(n.code,{children:"package.json"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Defaults to ",(0,r.jsx)(n.code,{children:"GET /api/<name>"})," when flags are omitted."]}),"\n",(0,r.jsxs)(n.li,{children:["Populates manifest metadata (",(0,r.jsx)(n.code,{children:"summary"}),", ",(0,r.jsx)(n.code,{children:"description"}),", ",(0,r.jsx)(n.code,{children:"tags"}),") plus request/response schema references supplied via CLI flags. Schema references follow the ",(0,r.jsx)(n.code,{children:"kind:name@source"})," format described in the ",(0,r.jsxs)(n.a,{href:"https://github.com/webstir-io/module-contract#schema-references",children:[(0,r.jsx)(n.code,{children:"@webstir-io/module-contract"})," schema guidance"]})," (",(0,r.jsx)(n.code,{children:"kind"})," defaults to ",(0,r.jsx)(n.code,{children:"zod"}),", ",(0,r.jsx)(n.code,{children:"@source"})," optional)."]}),"\n",(0,r.jsxs)(n.li,{children:["With ",(0,r.jsx)(n.code,{children:"--fastify"}),", also scaffolds ",(0,r.jsx)(n.code,{children:"src/backend/server/routes/<name>.ts"})," and attempts to import/register it in ",(0,r.jsx)(n.code,{children:"src/backend/server/fastify.ts"})," when present."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Options:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--method"})," HTTP method (e.g., GET, POST). Default: GET"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--path"})," Route path (e.g., /api/users). Default: ",(0,r.jsx)(n.code,{children:"/api/<name>"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--project-name <project>"})," Target a specific workspace project when multiple exist."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--fastify"})," Also scaffold a Fastify handler and register it if possible"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--summary <text>"})," Adds a short human-readable summary to the manifest entry."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--description <text>"})," Adds a longer description to the manifest entry."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--tags tag1,tag2"})," Comma-separated tags (trimmed and deduped case-insensitively)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--params-schema <ref>"})," Reference for route params."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--query-schema <ref>"})," Reference for query params."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--body-schema <ref>"})," Reference for request bodies."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--headers-schema <ref>"})," Reference for request headers."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--response-schema <ref>"})," Reference for the success response body."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--response-status <code>"})," Overrides the success status code (must be 100-599)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--response-headers-schema <ref>"})," Reference for response headers."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Schema flags (",(0,r.jsx)(n.code,{children:"--*-schema"}),") expect the ",(0,r.jsx)(n.code,{children:"kind:name@source"})," string noted above. Omit ",(0,r.jsx)(n.code,{children:"kind:"})," for Zod schemas and skip ",(0,r.jsx)(n.code,{children:"@source"})," when the schema lives beside the generator output. Invalid ",(0,r.jsx)(n.code,{children:"kind"})," values or missing ",(0,r.jsx)(n.code,{children:"name"})," segments cause CLI validation errors before any files are written."]}),"\n",(0,r.jsx)(n.h3,{id:"add-job",children:"add-job"}),"\n",(0,r.jsxs)(n.p,{children:["Usage: ",(0,r.jsx)(n.code,{children:"webstir add-job <name> [--schedule <expression>] [--project-name <project>]"})]}),"\n",(0,r.jsx)(n.p,{children:"What it does:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Creates ",(0,r.jsx)(n.code,{children:"src/backend/jobs/<name>/index.ts"})," and adds an entry to ",(0,r.jsx)(n.code,{children:"webstir.module.jobs"})," in ",(0,r.jsx)(n.code,{children:"package.json"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["The job stub exports a ",(0,r.jsx)(n.code,{children:"run()"})," function and is directly executable during development."]}),"\n",(0,r.jsxs)(n.li,{children:["Accepts optional metadata so manifest entries stay self-documenting (",(0,r.jsx)(n.code,{children:"description"}),", ",(0,r.jsx)(n.code,{children:"priority"}),"). Priority accepts either integers or arbitrary strings; numeric values are stored as numbers."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Options:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--schedule"})," Optional schedule string (free-form, often cron-like, e.g., ",(0,r.jsx)(n.code,{children:"0 0 * * *"}),"). Stored as-is in the manifest."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--project-name <project>"})," Target a specific workspace project when multiple exist."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--description <text>"})," Adds a longer explanation for the job alongside the manifest entry."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--priority <number|string>"})," Stores a numeric priority when parsable or falls back to the provided string unchanged."]}),"\n",(0,r.jsxs)(n.li,{children:["After scaffolding, run ",(0,r.jsx)(n.code,{children:"node build/backend/jobs/scheduler.js --list|--job <name>|--watch"})," (or the TypeScript equivalent via ",(0,r.jsx)(n.code,{children:"tsx"}),") to inspect and execute jobs locally. The embedded watcher supports ",(0,r.jsx)(n.code,{children:"@hourly"}),", ",(0,r.jsx)(n.code,{children:"@daily"}),", ",(0,r.jsx)(n.code,{children:"@weekly"}),", ",(0,r.jsx)(n.code,{children:"@reboot"}),", and ",(0,r.jsx)(n.code,{children:"rate(n units)"})," expressions; other cron strings are recorded for your production scheduler."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"smoke",children:"smoke"}),"\n",(0,r.jsxs)(n.p,{children:["Usage: ",(0,r.jsx)(n.code,{children:"webstir smoke [workspace]"})]}),"\n",(0,r.jsx)(n.p,{children:"What it does:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Copies the embedded Accounts backend example into ",(0,r.jsx)(n.code,{children:"CLI/out/smoke/accounts"})," (unless a workspace path is provided)."]}),"\n",(0,r.jsxs)(n.li,{children:["Installs dependencies, runs the standard build workflow, and loads ",(0,r.jsx)(n.code,{children:".webstir/backend-manifest.json"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Prints the manifest location, capabilities, and route definitions; exits non-zero when no routes are present."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Notes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Provide a workspace path to reuse an existing project instead of copying the example."}),"\n",(0,r.jsxs)(n.li,{children:["Requires local access to the framework packages; configure ",(0,r.jsx)(n.code,{children:".npmrc"})," or set ",(0,r.jsx)(n.code,{children:"GH_PACKAGES_TOKEN"})," when registry installs are needed."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"dev-server--watch",children:"Dev Server & Watch"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Serves ",(0,r.jsx)(n.code,{children:"build/"})," over ASP.NET Core with an SSE endpoint for live reload."]}),"\n",(0,r.jsxs)(n.li,{children:["Proxies API requests from ",(0,r.jsx)(n.code,{children:"/api/*"})," to the Node server."]}),"\n",(0,r.jsx)(n.li,{children:"Clean URLs and sensible cache headers for dev vs. prod."}),"\n",(0,r.jsx)(n.li,{children:"File watching uses a buffered queue to avoid thrashing on burst changes."}),"\n",(0,r.jsxs)(n.li,{children:["Collects client errors at ",(0,r.jsx)(n.code,{children:"POST /client-errors"})," (expects JSON, up to 32KB). Responds with ",(0,r.jsx)(n.code,{children:"204"})," on success; forwards to the error tracking hook."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Change impact:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Frontend change \u2192 rebuild affected page/assets \u2192 broadcast reload via SSE."}),"\n",(0,r.jsx)(n.li,{children:"Backend change \u2192 rebuild backend \u2192 restart Node process."}),"\n",(0,r.jsx)(n.li,{children:"Shared change \u2192 rebuild both sides that depend on shared modules."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"build--publish-pipelines",children:"Build & Publish Pipelines"}),"\n",(0,r.jsx)(n.p,{children:"HTML:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Page HTML merges into ",(0,r.jsx)(n.code,{children:"src/frontend/app/app.html"})," (requires a ",(0,r.jsx)(n.code,{children:"<main>"})," element) and is written to ",(0,r.jsx)(n.code,{children:"build/frontend/pages/<page>/index.html"})," in dev."]}),"\n",(0,r.jsx)(n.li,{children:"In publish, HTML is minified and rewritten to reference fingerprinted assets listed in a per-page manifest."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"CSS:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Resolves ",(0,r.jsx)(n.code,{children:"@import"})," and URL references; copies assets."]}),"\n",(0,r.jsx)(n.li,{children:"In publish, supports optional CSS Modules, autoprefixing, and minification."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"JavaScript/TypeScript:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Uses ",(0,r.jsx)(n.code,{children:"tsc --build"})," with an embedded ",(0,r.jsx)(n.code,{children:"base.tsconfig.json"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"ESM-only module graph."}),"\n",(0,r.jsx)(n.li,{children:"Tree-shakes and minifies in publish."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Outputs:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Dev: ",(0,r.jsx)(n.code,{children:"build/frontend/**"}),", ",(0,r.jsx)(n.code,{children:"build/backend/**"})," with readable output and live-reload."]}),"\n",(0,r.jsxs)(n.li,{children:["Prod: ",(0,r.jsx)(n.code,{children:"dist/frontend/pages/<page>/index.<timestamp>.{css|js}"}),", HTML with rewritten links, and a per-page ",(0,r.jsx)(n.code,{children:"manifest.json"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"project-layout",children:"Project Layout"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Base HTML: ",(0,r.jsx)(n.code,{children:"src/frontend/app/app.html"})," contains a ",(0,r.jsx)(n.code,{children:"<main>"})," used for page composition."]}),"\n",(0,r.jsxs)(n.li,{children:["Pages: ",(0,r.jsx)(n.code,{children:"src/frontend/pages/<page>/index.html|css|ts"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["App assets: ",(0,r.jsx)(n.code,{children:"src/frontend/app/*"})," (copied as-is to ",(0,r.jsx)(n.code,{children:"build/"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Shared types/modules: ",(0,r.jsx)(n.code,{children:"src/shared/"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Backend entry: ",(0,r.jsx)(n.code,{children:"src/backend/index.ts"})," \u2192 ",(0,r.jsx)(n.code,{children:"build/backend/index.js"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Create a full-stack app: ",(0,r.jsx)(n.code,{children:"webstir init my-app && cd my-app && webstir watch"})]}),"\n",(0,r.jsxs)(n.li,{children:["Frontend-only app: ",(0,r.jsx)(n.code,{children:"webstir init --client-only my-client && cd my-client && webstir watch"})]}),"\n",(0,r.jsxs)(n.li,{children:["Clean build: ",(0,r.jsx)(n.code,{children:"webstir build --clean"})]}),"\n",(0,r.jsxs)(n.li,{children:["Add a page: ",(0,r.jsx)(n.code,{children:"webstir add-page about && webstir watch"})]}),"\n",(0,r.jsxs)(n.li,{children:["Publish for production: ",(0,r.jsx)(n.code,{children:"webstir publish"})]}),"\n",(0,r.jsxs)(n.li,{children:["Refresh framework packages: ",(0,r.jsx)(n.code,{children:"webstir install --clean"})]}),"\n",(0,r.jsxs)(n.li,{children:["Run tests with Vitest: ",(0,r.jsx)(n.code,{children:"WEBSTIR_TESTING_PROVIDER=@webstir-io/vitest-testing webstir test"})]}),"\n",(0,r.jsxs)(n.li,{children:["Verify backend manifest ingestion: ",(0,r.jsx)(n.code,{children:"webstir smoke"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"help-output-sample",children:"Help Output (Sample)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ webstir --help\nwebstir - Modern web development build tool\n\nUsage: webstir [command] [options] [path]\n\nCommands:\n  add-job       Add a backend job stub and manifest entry. Metadata flags are documented at https://github.com/webstir-io/webstir-portal/blob/main/docs/reference/cli.md#add-job\n  add-page      Add a new page (frontend only)\n  add-route     Add a backend route entry to the module manifest (package.json). Metadata and schema flags are documented at https://github.com/webstir-io/webstir-portal/blob/main/docs/reference/cli.md#add-route\n  add-test      Scaffold a starter test\n  build         Build the project once\n  help          Show help information\n  init          Initialize a new webstir project\n  install       Synchronize framework package dependencies from the registry\n  publish       Create production build\n  smoke         Run the accounts example through the CLI and report backend manifest routes\n  test          Run tests through the configured provider (defaults to @webstir-io/webstir-testing)\n  watch         Build and watch for changes (default)\n\nRun 'webstir help <command>' for more information on a specific command.\n\nPath parameter:\n  You can specify a path as the last argument to run commands in a different directory.\n\nNotes:\n  Workers are injected (IWorkflowWorker); 'add-page' targets the frontend worker.\n\nExamples:\n  webstir build ./my-project         # Build project in ./my-project directory\n  webstir watch /path/to/project     # Watch project at absolute path\n  webstir init new-app               # Initialize new project in new-app directory\n  WEBSTIR_TESTING_PROVIDER=@webstir-io/vitest-testing webstir test   # Run tests with the Vitest provider\n  webstir install                    # Sync registry packages and providers\n  webstir test --help               # See provider override guidance\n  webstir smoke                    # Run the accounts smoke check and report manifest routes\n\n$ webstir help build\nBuild the project once\n\nUsage: webstir build [options]\n\nOptions:\n  --clean             Clean build directory before building\n\nExamples:\n  webstir build                           # Build the project\n  webstir build --clean                   # Clean build (removes build directory first)\n  webstir build ./my-app                  # Build project in ./my-app directory\n"})}),"\n",(0,r.jsx)(n.h2,{id:"exit-codes",children:"Exit Codes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"0"}),": Success"]}),"\n",(0,r.jsx)(n.li,{children:"Non-zero: Error (build failure, test failure, invalid arguments, or runtime error)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"contributing-notes",children:"Contributing Notes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Commands live in ",(0,r.jsx)(n.code,{children:"CLI/"}),"; workflows and services live in ",(0,r.jsx)(n.code,{children:"Engine/"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Engine/Workflows/"})," orchestrates ",(0,r.jsx)(n.code,{children:"init"}),", ",(0,r.jsx)(n.code,{children:"build"}),", ",(0,r.jsx)(n.code,{children:"watch"}),", ",(0,r.jsx)(n.code,{children:"test"}),", ",(0,r.jsx)(n.code,{children:"publish"}),", ",(0,r.jsx)(n.code,{children:"add-page"}),", ",(0,r.jsx)(n.code,{children:"add-test"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"AppWorkspace"})," and ",(0,r.jsx)(n.code,{children:"Engine/Constants.cs"})," for paths. Avoid manual string manipulation; prefer helpers in ",(0,r.jsx)(n.code,{children:"Engine.Extensions"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Keep changes minimal and behavior-preserving. Follow ",(0,r.jsx)(n.a,{href:"https://github.com/webstir-io/webstir-dotnet/blob/main/.codex/style.md",children:".codex/style.md"})," and ",(0,r.jsx)(n.code,{children:".editorconfig"})," when editing C#."]}),"\n",(0,r.jsxs)(n.li,{children:["Framework packaging commands live in ",(0,r.jsx)(n.code,{children:"Framework/Framework.csproj"}),"; run ",(0,r.jsx)(n.code,{children:"dotnet run --project Framework/Framework.csproj -- packages ..."})," when rebuilding bundles."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"related-docs",children:"Related Docs"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["High-level solution overview \u2014 ",(0,r.jsx)(n.a,{href:"/docs/explanations/solution",children:"solution"})]}),"\n",(0,r.jsxs)(n.li,{children:["Templates \u2014 ",(0,r.jsx)(n.a,{href:"/docs/reference/templates",children:"templates"})]}),"\n",(0,r.jsxs)(n.li,{children:["Testing \u2014 ",(0,r.jsx)(n.a,{href:"https://github.com/webstir-io/webstir-dotnet/blob/main/.codex/testing.md",children:"orchestrator testing guide"}),", ",(0,r.jsx)(n.a,{href:"/docs/explanations/testing",children:"tests"})]}),"\n",(0,r.jsxs)(n.li,{children:["Workspace and paths \u2014 ",(0,r.jsx)(n.a,{href:"/docs/explanations/workspace",children:"workspace"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);