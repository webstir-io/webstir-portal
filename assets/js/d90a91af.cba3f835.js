"use strict";(self.webpackChunkwebstir_portal=self.webpackChunkwebstir_portal||[]).push([[9240],{832:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"explanations/testing","title":"Testing","description":"How we test the Webstir solution and what we lock down. This expands the high-level approach in the orchestrator testing guide and focuses on the CLI/Engine.","source":"@site/docs/explanations/testing.md","sourceDirName":"explanations","slug":"/explanations/testing","permalink":"/docs/explanations/testing","draft":false,"unlisted":false,"editUrl":"https://github.com/webstir-io/webstir-portal/edit/main/docs/explanations/testing.md","tags":[],"version":"current","lastUpdatedAt":1764454564000,"frontMatter":{},"sidebar":"explanations","previous":{"title":"Solution","permalink":"/docs/explanations/solution"},"next":{"title":"Workspace","permalink":"/docs/explanations/workspace"}}');var i=n(4848),r=n(8453);const l={},o="Testing",a={},d=[{value:"Overview",id:"overview",level:2},{value:"What We Test",id:"what-we-test",level:2},{value:"What We Don\u2019t Test",id:"what-we-dont-test",level:2},{value:"Test Types",id:"test-types",level:2},{value:"Harness &amp; Structure",id:"harness--structure",level:2},{value:"Snapshots",id:"snapshots",level:2},{value:"Running Tests",id:"running-tests",level:2},{value:"Writing Tests",id:"writing-tests",level:2},{value:"Dev Server &amp; Watch",id:"dev-server--watch",level:2},{value:"Publish Specifics",id:"publish-specifics",level:2},{value:"Determinism &amp; Flakiness",id:"determinism--flakiness",level:2},{value:"Related Docs",id:"related-docs",level:2}];function c(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"testing",children:"Testing"})}),"\n",(0,i.jsxs)(s.p,{children:["How we test the Webstir solution and what we lock down. This expands the high-level approach in the ",(0,i.jsx)(s.a,{href:"https://github.com/webstir-io/webstir-dotnet/blob/main/.codex/testing.md",children:"orchestrator testing guide"})," and focuses on the CLI/Engine."]}),"\n",(0,i.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Goal: protect the developer experience, not chase coverage."}),"\n",(0,i.jsx)(s.li,{children:"Focus: end-to-end CLI workflows and published outputs."}),"\n",(0,i.jsx)(s.li,{children:"Contract first: commands, flags, exit codes, folder structure, manifests, and dev behavior (reload, proxy)."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"what-we-test",children:"What We Test"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Workflows: init \u2192 build \u2192 watch \u2192 test \u2192 publish. See ",(0,i.jsx)(s.a,{href:"/docs/reference/workflows",children:"workflows"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["Generators: ",(0,i.jsx)(s.code,{children:"add-page"}),", ",(0,i.jsx)(s.code,{children:"add-test"})," create expected files and integrate with builds."]}),"\n",(0,i.jsxs)(s.li,{children:["Contracts: directory layout, build artifacts, per-page ",(0,i.jsx)(s.code,{children:"manifest.json"}),", rewritten HTML links."]}),"\n",(0,i.jsxs)(s.li,{children:["Dev behavior: dev web server serves pages, proxies ",(0,i.jsx)(s.code,{children:"/api/*"}),", live reload via SSE."]}),"\n",(0,i.jsxs)(s.li,{children:["Error paths: invalid flags, missing ",(0,i.jsx)(s.code,{children:"<main>"})," in ",(0,i.jsx)(s.code,{children:"app.html"}),", TypeScript errors, failing tests \u2192 non-zero exit."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"what-we-dont-test",children:"What We Don\u2019t Test"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Private helpers, wiring details, or internal classes."}),"\n",(0,i.jsx)(s.li,{children:"Line-by-line coverage metrics."}),"\n",(0,i.jsx)(s.li,{children:"Transient implementation quirks that don\u2019t affect public behavior."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"test-types",children:"Test Types"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["End-to-End CLI: run ",(0,i.jsx)(s.code,{children:"webstir"})," commands against a temp workspace and assert outputs."]}),"\n",(0,i.jsx)(s.li,{children:"Snapshot (golden) tests: compare generated files or folder trees to known-good versions."}),"\n",(0,i.jsx)(s.li,{children:"Property tests: invariants like \u201cany project name that matches rules builds\u201d, \u201cpage names are normalized consistently\u201d."}),"\n",(0,i.jsx)(s.li,{children:"Smoke checks: dev server responds on a port; watch triggers rebuild on file change."}),"\n",(0,i.jsx)(s.li,{children:"Error scenario tests: bad input produces clear messages and non-zero exit codes."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"harness--structure",children:"Harness & Structure"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Location: ",(0,i.jsx)(s.code,{children:"Tester/"})," \u2014 xUnit project that executes the CLI/Engine workflows under ",(0,i.jsx)(s.code,{children:"dotnet test"}),"."]}),"\n",(0,i.jsx)(s.li,{children:"Isolation: each test runs in a unique temp directory; no global state."}),"\n",(0,i.jsx)(s.li,{children:"Process: spawn CLI via the test harness, capture stdout/stderr, and check exit codes."}),"\n",(0,i.jsxs)(s.li,{children:["Filesystem: assert on existence, contents, and structure of ",(0,i.jsx)(s.code,{children:"build/"})," and ",(0,i.jsx)(s.code,{children:"dist/"}),"."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"snapshots",children:"Snapshots"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Use snapshots to lock down scaffolding and publish outputs."}),"\n",(0,i.jsx)(s.li,{children:"Keep snapshots readable; prefer whole-file or folder snapshots over brittle line assertions."}),"\n",(0,i.jsx)(s.li,{children:"Normalize dynamic data (timestamps, absolute paths, random IDs) before comparing."}),"\n",(0,i.jsx)(s.li,{children:"When a legitimate change occurs, review and update the snapshot intentionally."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"running-tests",children:"Running Tests"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Repo tests (engine/CLI): run ",(0,i.jsx)(s.code,{children:"dotnet test Tester/Tester.csproj"})," (set ",(0,i.jsx)(s.code,{children:"WEBSTIR_TEST_MODE=full"})," for the full suite or pass ",(0,i.jsx)(s.code,{children:'--filter "Category=..."'}),")."]}),"\n",(0,i.jsxs)(s.li,{children:["Generated project tests: inside a project created by ",(0,i.jsx)(s.code,{children:"webstir init"}),", run ",(0,i.jsx)(s.code,{children:"webstir test"})," (delegates to the ",(0,i.jsx)(s.code,{children:"webstir-test"})," CLI)."]}),"\n",(0,i.jsx)(s.li,{children:"CI: relies on standard exit codes; non-zero fails the job."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"writing-tests",children:"Writing Tests"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Choose behavior to lock down (a workflow, generator, or contract)."}),"\n",(0,i.jsxs)(s.li,{children:["Arrange: create a temp workspace; optionally run ",(0,i.jsx)(s.code,{children:"webstir init"})," with flags."]}),"\n",(0,i.jsxs)(s.li,{children:["Act: run the target command (",(0,i.jsx)(s.code,{children:"build"}),", ",(0,i.jsx)(s.code,{children:"watch"})," smoke, ",(0,i.jsx)(s.code,{children:"publish"}),", generator)."]}),"\n",(0,i.jsx)(s.li,{children:"Assert: check exit code, logs for key messages, and the filesystem outputs."}),"\n",(0,i.jsx)(s.li,{children:"For snapshots: generate output, normalize dynamic values, compare to the approved snapshot."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"dev-server--watch",children:"Dev Server & Watch"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Smoke test: after ",(0,i.jsx)(s.code,{children:"watch"})," starts, the web server responds and logs \u201cwatching\u201d state."]}),"\n",(0,i.jsx)(s.li,{children:"Change test: touch a frontend file \u2192 expect frontend rebuild + reload signal; touch a backend file \u2192 expect backend restart."}),"\n",(0,i.jsxs)(s.li,{children:["Proxy test: request under ",(0,i.jsx)(s.code,{children:"/api/*"})," routes to the Node server."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"publish-specifics",children:"Publish Specifics"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Fingerprinted assets: expect per-page ",(0,i.jsx)(s.code,{children:"index.<timestamp>.{css|js}"})," written to ",(0,i.jsx)(s.code,{children:"dist/frontend/pages/<page>/"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["HTML rewrite: page HTML references fingerprinted assets using the per-page ",(0,i.jsx)(s.code,{children:"manifest.json"}),"."]}),"\n",(0,i.jsx)(s.li,{children:"Minification: HTML/CSS/JS are minified; comments and source maps removed."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"determinism--flakiness",children:"Determinism & Flakiness"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Avoid port conflicts by using OS-assigned ports or a shared allocator."}),"\n",(0,i.jsx)(s.li,{children:"Use generous but bounded timeouts; don\u2019t rely on sleeps where event signals exist."}),"\n",(0,i.jsx)(s.li,{children:"Normalize any time-based names and absolute paths before assertions."}),"\n",(0,i.jsx)(s.li,{children:"Batch file changes to avoid excessive rebuilds in watch tests."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"related-docs",children:"Related Docs"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Solution overview \u2014 ",(0,i.jsx)(s.a,{href:"/docs/explanations/solution",children:"solution"})]}),"\n",(0,i.jsxs)(s.li,{children:["CLI reference \u2014 ",(0,i.jsx)(s.a,{href:"/docs/reference/cli",children:"cli"})]}),"\n",(0,i.jsxs)(s.li,{children:["Engine internals \u2014 ",(0,i.jsx)(s.a,{href:"/docs/explanations/engine",children:"engine"})]}),"\n",(0,i.jsxs)(s.li,{children:["Pipelines \u2014 ",(0,i.jsx)(s.a,{href:"/docs/explanations/pipelines",children:"pipelines"})]}),"\n",(0,i.jsxs)(s.li,{children:["Testing \u2014 ",(0,i.jsx)(s.a,{href:"/docs/explanations/testing",children:"tests"}),", ",(0,i.jsx)(s.a,{href:"https://github.com/webstir-io/webstir-dotnet/blob/main/.codex/testing.md",children:"orchestrator testing guide"})]}),"\n",(0,i.jsxs)(s.li,{children:["Workspace and paths \u2014 ",(0,i.jsx)(s.a,{href:"/docs/explanations/workspace",children:"workspace"})]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>o});var t=n(6540);const i={},r=t.createContext(i);function l(e){const s=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(r.Provider,{value:s},e.children)}}}]);