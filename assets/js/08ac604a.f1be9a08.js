"use strict";(self.webpackChunkwebstir_portal=self.webpackChunkwebstir_portal||[]).push([[5300],{4336:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"explanations/workspace","title":"Workspace","description":"Defines and manages all project paths. The engine builds an AppWorkspace from a root directory and uses it to locate sources, outputs, templates, and runtime artifacts. Centralizing paths keeps code simple and avoids fragile string operations.","source":"@site/docs/explanations/workspace.md","sourceDirName":"explanations","slug":"/explanations/workspace","permalink":"/docs/explanations/workspace","draft":false,"unlisted":false,"editUrl":"https://github.com/webstir-io/webstir-portal/edit/main/docs/explanations/workspace.md","tags":[],"version":"current","lastUpdatedAt":1761061153000,"frontMatter":{},"sidebar":"explanations","previous":{"title":"Testing","permalink":"/docs/explanations/testing"}}');var d=s(4848),r=s(8453);const l={},c="Workspace",t={},o=[{value:"Goals",id:"goals",level:2},{value:"Roots",id:"roots",level:2},{value:"Conventions",id:"conventions",level:2},{value:"Constants &amp; Helpers",id:"constants--helpers",level:2},{value:"AppWorkspace",id:"appworkspace",level:2},{value:"Deriving Paths (Examples)",id:"deriving-paths-examples",level:2},{value:"Watching &amp; Ignore Rules",id:"watching--ignore-rules",level:2},{value:"Contracts",id:"contracts",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Related Docs",id:"related-docs",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"workspace",children:"Workspace"})}),"\n",(0,d.jsxs)(n.p,{children:["Defines and manages all project paths. The engine builds an ",(0,d.jsx)(n.code,{children:"AppWorkspace"})," from a root directory and uses it to locate sources, outputs, templates, and runtime artifacts. Centralizing paths keeps code simple and avoids fragile string operations."]}),"\n",(0,d.jsx)(n.h2,{id:"goals",children:"Goals"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Single source of truth for folders and files."}),"\n",(0,d.jsx)(n.li,{children:"No hardcoded strings scattered around the codebase."}),"\n",(0,d.jsx)(n.li,{children:"Easy to compute relative and derived paths safely."}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"roots",children:"Roots"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Source roots","\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Frontend: ",(0,d.jsx)(n.code,{children:"src/frontend"})]}),"\n",(0,d.jsxs)(n.li,{children:["Pages: ",(0,d.jsx)(n.code,{children:"src/frontend/pages/<page>"})]}),"\n",(0,d.jsxs)(n.li,{children:["App assets: ",(0,d.jsx)(n.code,{children:"src/frontend/app"})]}),"\n",(0,d.jsxs)(n.li,{children:["Images: ",(0,d.jsx)(n.code,{children:"src/frontend/images"})]}),"\n",(0,d.jsxs)(n.li,{children:["Fonts: ",(0,d.jsx)(n.code,{children:"src/frontend/fonts"})]}),"\n",(0,d.jsxs)(n.li,{children:["Media: ",(0,d.jsx)(n.code,{children:"src/frontend/media"})]}),"\n",(0,d.jsxs)(n.li,{children:["Backend: ",(0,d.jsx)(n.code,{children:"src/backend"})]}),"\n",(0,d.jsxs)(n.li,{children:["Shared: ",(0,d.jsx)(n.code,{children:"src/shared"})]}),"\n",(0,d.jsxs)(n.li,{children:["Types: ",(0,d.jsx)(n.code,{children:"types"})]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["Build roots (dev)","\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Frontend: ",(0,d.jsx)(n.code,{children:"build/frontend"})]}),"\n",(0,d.jsxs)(n.li,{children:["Pages: ",(0,d.jsx)(n.code,{children:"build/frontend/pages/<page>"})]}),"\n",(0,d.jsxs)(n.li,{children:["Images: ",(0,d.jsx)(n.code,{children:"build/frontend/images"})]}),"\n",(0,d.jsxs)(n.li,{children:["Fonts: ",(0,d.jsx)(n.code,{children:"build/frontend/fonts"})]}),"\n",(0,d.jsxs)(n.li,{children:["Media: ",(0,d.jsx)(n.code,{children:"build/frontend/media"})]}),"\n",(0,d.jsxs)(n.li,{children:["Backend: ",(0,d.jsx)(n.code,{children:"build/backend"})]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["Dist roots (publish)","\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Frontend: ",(0,d.jsx)(n.code,{children:"dist/frontend"})]}),"\n",(0,d.jsxs)(n.li,{children:["Pages: ",(0,d.jsx)(n.code,{children:"dist/frontend/pages/<page>"})]}),"\n",(0,d.jsxs)(n.li,{children:["Images: ",(0,d.jsx)(n.code,{children:"dist/frontend/images"})]}),"\n",(0,d.jsxs)(n.li,{children:["Fonts: ",(0,d.jsx)(n.code,{children:"dist/frontend/fonts"})]}),"\n",(0,d.jsxs)(n.li,{children:["Media: ",(0,d.jsx)(n.code,{children:"dist/frontend/media"})]}),"\n",(0,d.jsxs)(n.li,{children:["App assets: ",(0,d.jsx)(n.code,{children:"dist/frontend/app"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"conventions",children:"Conventions"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Base HTML lives at ",(0,d.jsx)(n.code,{children:"src/frontend/app/app.html"})," and contains a ",(0,d.jsx)(n.code,{children:"<main>"})," where page HTML merges."]}),"\n",(0,d.jsxs)(n.li,{children:["Pages live under ",(0,d.jsx)(n.code,{children:"src/frontend/pages/<page>/"})," with ",(0,d.jsx)(n.code,{children:"index.html|css|ts"})," (publish may produce ",(0,d.jsx)(n.code,{children:"index.<timestamp>.{css|js}"})," and ",(0,d.jsx)(n.code,{children:"manifest.json"}),")."]}),"\n",(0,d.jsxs)(n.li,{children:["Backend entry is ",(0,d.jsx)(n.code,{children:"src/backend/index.ts"})," \u2192 compiled to ",(0,d.jsx)(n.code,{children:"build/backend/index.js"}),"."]}),"\n",(0,d.jsxs)(n.li,{children:["Shared modules under ",(0,d.jsx)(n.code,{children:"src/shared/"})," are consumed by both frontend and backend."]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"constants--helpers",children:"Constants & Helpers"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Constants live in ",(0,d.jsx)(n.code,{children:"Engine/Constants.cs"})," (folders, file names, extensions)."]}),"\n",(0,d.jsxs)(n.li,{children:["Do not hand-roll path strings. Use helpers:","\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"Engine.Extensions.PathExtensions"}),": ",(0,d.jsx)(n.code,{children:"Combine"}),", ",(0,d.jsx)(n.code,{children:"DirectoryName"}),", ",(0,d.jsx)(n.code,{children:"Exists"}),", ",(0,d.jsx)(n.code,{children:"Files"}),", ",(0,d.jsx)(n.code,{children:"Folders"}),", ",(0,d.jsx)(n.code,{children:"Create"}),"."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"Engine.Extensions.DirectoryExtensions"}),": ",(0,d.jsx)(n.code,{children:"CreateSubDirectory"}),", ",(0,d.jsx)(n.code,{children:"CopyToAsync"}),", etc."]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["Use ",(0,d.jsx)(n.code,{children:"Path.GetRelativePath"})," for relativity where needed."]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"appworkspace",children:"AppWorkspace"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Created from the working directory (or an explicit path when provided by the CLI)."}),"\n",(0,d.jsxs)(n.li,{children:["Exposes typed properties for common roots (e.g., ",(0,d.jsx)(n.code,{children:"FrontendBuildPath"}),", ",(0,d.jsx)(n.code,{children:"BackendBuildPath"}),", ",(0,d.jsx)(n.code,{children:"FrontendDistPath"}),")."]}),"\n",(0,d.jsx)(n.li,{children:"Provides methods to resolve page locations, outputs, and temp files."}),"\n",(0,d.jsx)(n.li,{children:"Validates required inputs (e.g., base HTML, server entry) and raises clear errors when missing."}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"deriving-paths-examples",children:"Deriving Paths (Examples)"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Page folder: ",(0,d.jsx)(n.code,{children:'Combine(FrontendPath, "pages", pageName)'})]}),"\n",(0,d.jsxs)(n.li,{children:["Page dev HTML: ",(0,d.jsx)(n.code,{children:'Combine(FrontendBuildPagesPath, pageName, "index.html")'})]}),"\n",(0,d.jsxs)(n.li,{children:["Page dist bundle: ",(0,d.jsx)(n.code,{children:'Combine(FrontendDistPagesPath, pageName, "index.<timestamp>.js")'})]}),"\n",(0,d.jsxs)(n.li,{children:["Backend build output: ",(0,d.jsx)(n.code,{children:'Combine(BackendBuildPath, "index.js")'})]}),"\n",(0,d.jsxs)(n.li,{children:["Manifest: ",(0,d.jsx)(n.code,{children:'Combine(FrontendDistPagesPath, pageName, "manifest.json")'})]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"watching--ignore-rules",children:"Watching & Ignore Rules"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Watch ",(0,d.jsx)(n.code,{children:"src/**"})," for changes and ignore ",(0,d.jsx)(n.code,{children:"build/**"})," and ",(0,d.jsx)(n.code,{children:"dist/**"}),"."]}),"\n",(0,d.jsx)(n.li,{children:"Batch events to avoid thrashing on save bursts."}),"\n",(0,d.jsxs)(n.li,{children:["Route changes by area:","\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Frontend change \u2192 rebuild affected page/assets."}),"\n",(0,d.jsx)(n.li,{children:"Backend change \u2192 rebuild backend and restart Node."}),"\n",(0,d.jsx)(n.li,{children:"Shared change \u2192 rebuild both as needed."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"contracts",children:"Contracts"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"The directory structure above is part of the public contract tested by E2E tests."}),"\n",(0,d.jsxs)(n.li,{children:["Fingerprinted assets and manifests under ",(0,d.jsx)(n.code,{children:"dist/frontend/pages/<page>/"})," are required for publish."]}),"\n",(0,d.jsxs)(n.li,{children:["Clean URLs depend on the ",(0,d.jsx)(n.code,{children:"pages/<page>/index.html"})," convention."]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Missing base HTML or backend entry \u2192 fail fast with actionable messages."}),"\n",(0,d.jsx)(n.li,{children:"Invalid page names or paths \u2192 normalized and validated before use."}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"related-docs",children:"Related Docs"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Solution overview \u2014 ",(0,d.jsx)(n.a,{href:"/docs/explanations/solution",children:"solution"})]}),"\n",(0,d.jsxs)(n.li,{children:["Engine internals \u2014 ",(0,d.jsx)(n.a,{href:"/docs/explanations/engine",children:"engine"})]}),"\n",(0,d.jsxs)(n.li,{children:["Pipelines \u2014 ",(0,d.jsx)(n.a,{href:"/docs/explanations/pipelines",children:"pipelines"})]}),"\n",(0,d.jsxs)(n.li,{children:["Dev service \u2014 ",(0,d.jsx)(n.a,{href:"/docs/explanations/devservice",children:"devservice"})]}),"\n",(0,d.jsxs)(n.li,{children:["Tests \u2014 ",(0,d.jsx)(n.a,{href:"/docs/explanations/testing",children:"tests"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>c});var i=s(6540);const d={},r=i.createContext(d);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);