"use strict";(self.webpackChunkwebstir_portal=self.webpackChunkwebstir_portal||[]).push([[9131],{8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var i=s(6540);const r={},d=i.createContext(r);function t(e){const n=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(d.Provider,{value:n},e.children)}},9415:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"how-to/publish","title":"Publish","description":"Produce optimized, fingerprinted assets in dist/ and rewrite HTML to reference them. Intended for production deploys and the Docker sandbox.","source":"@site/docs/how-to/publish.md","sourceDirName":"how-to","slug":"/how-to/publish","permalink":"/docs/how-to/publish","draft":false,"unlisted":false,"editUrl":"https://github.com/webstir-io/webstir-portal/edit/main/docs/how-to/publish.md","tags":[],"version":"current","lastUpdatedAt":1762915999000,"frontMatter":{},"sidebar":"howTo","previous":{"title":"Public Launch & Repo Pattern","permalink":"/docs/how-to/public-launch-checklist"},"next":{"title":"Sandbox","permalink":"/docs/how-to/sandbox"}}');var r=s(4848),d=s(8453);const t={},l="Publish",o={},c=[{value:"Purpose",id:"purpose",level:2},{value:"When To Use",id:"when-to-use",level:2},{value:"CLI",id:"cli",level:2},{value:"Steps",id:"steps",level:2},{value:"Outputs",id:"outputs",level:2},{value:"Notes",id:"notes",level:2},{value:"Errors &amp; Exit Codes",id:"errors--exit-codes",level:2},{value:"Related Docs",id:"related-docs",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"publish",children:"Publish"})}),"\n",(0,r.jsxs)(n.p,{children:["Produce optimized, fingerprinted assets in ",(0,r.jsx)(n.code,{children:"dist/"})," and rewrite HTML to reference them. Intended for production deploys and the Docker sandbox."]}),"\n",(0,r.jsx)(n.h2,{id:"purpose",children:"Purpose"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Create lean, cache-friendly assets with stable HTML references."}),"\n",(0,r.jsx)(n.li,{children:"Validate production routing and manifests."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"when-to-use",children:"When To Use"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Before deploying or validating with the Docker sandbox."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"cli",children:"CLI"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"webstir publish [--runtime <frontend|backend|all>]"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"steps",children:"Steps"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Run frontend and backend pipelines in production mode."}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.strong,{children:"esbuild"})," to bundle, tree-shake, minify JavaScript, and perform ",(0,r.jsx)(n.strong,{children:"automatic code-splitting"})," (10-100x faster)."]}),"\n",(0,r.jsxs)(n.li,{children:["esbuild handles content hashing for JavaScript: ",(0,r.jsx)(n.code,{children:"index-<hash>.js"})," for entries, ",(0,r.jsx)(n.code,{children:"chunks/*-<hash>.js"})," for shared code."]}),"\n",(0,r.jsxs)(n.li,{children:["Webstir fingerprints CSS assets: ",(0,r.jsx)(n.code,{children:"index.<hash>.css"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Minify HTML/CSS and remove comments and source maps."}),"\n",(0,r.jsxs)(n.li,{children:["Generate per-page ",(0,r.jsx)(n.code,{children:"manifest.json"})," with entry point mappings."]}),"\n",(0,r.jsx)(n.li,{children:"Rewrite page HTML to reference fingerprinted assets from the manifest."}),"\n",(0,r.jsxs)(n.li,{children:["Optimize and copy Images, Fonts, and Media to ",(0,r.jsx)(n.code,{children:"dist/frontend/{images|fonts|media}/**"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"outputs",children:"Outputs"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"dist/frontend/pages/<page>/index.html"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"dist/frontend/pages/<page>/index-<hash>.js"})," (entry point)"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"dist/frontend/pages/<page>/index.<hash>.css"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"dist/frontend/pages/<page>/manifest.json"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"dist/frontend/chunks/*-<hash>.js"})," (shared code chunks)"]}),"\n",(0,r.jsxs)(n.li,{children:["Static assets: ",(0,r.jsx)(n.code,{children:"dist/frontend/{images|fonts|media}/**"})]}),"\n",(0,r.jsxs)(n.li,{children:["Shared app assets under ",(0,r.jsx)(n.code,{children:"dist/frontend/app/*"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Code-splitting"}),": esbuild automatically extracts shared dependencies into chunks. The browser loads these transparently via ESM imports\u2014no manual chunk management needed."]}),"\n",(0,r.jsxs)(n.li,{children:["Dynamic imports are not inlined by the bundler in v1. If your page (or app) uses ",(0,r.jsx)(n.code,{children:"import('...')"}),", the call remains at runtime. For assets under the app shell, use absolute paths (e.g., ",(0,r.jsx)(n.code,{children:"await import('/app/router.js')"}),") so they resolve correctly after publish."]}),"\n",(0,r.jsx)(n.li,{children:"JavaScript minification via esbuild includes identifier mangling, dead code elimination, and console stripping."}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--runtime"})," / ",(0,r.jsx)(n.code,{children:"-r"}),": publish only the ",(0,r.jsx)(n.code,{children:"frontend"}),", only the ",(0,r.jsx)(n.code,{children:"backend"}),", or ",(0,r.jsx)(n.code,{children:"all"})," (default). Handy when you need to regenerate backend bundles for a job or API patch without touching the UI artifacts."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"webstir publish --runtime backend"})," \u2014 push a new backend bundle without rebuilding pages."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"webstir publish --runtime frontend"})," \u2014 ship UI fixes when server code is unchanged."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"errors--exit-codes",children:"Errors & Exit Codes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Non-zero on pipeline failures or missing inputs."}),"\n",(0,r.jsx)(n.li,{children:"Logs indicate which page or asset failed."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"related-docs",children:"Related Docs"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Workflows \u2014 ",(0,r.jsx)(n.a,{href:"/docs/reference/workflows",children:"workflows"})]}),"\n",(0,r.jsxs)(n.li,{children:["Pipelines \u2014 ",(0,r.jsx)(n.a,{href:"/docs/explanations/pipelines",children:"pipelines"})]}),"\n",(0,r.jsxs)(n.li,{children:["Servers (sandbox) \u2014 ",(0,r.jsx)(n.a,{href:"/docs/explanations/servers",children:"servers"})]}),"\n",(0,r.jsxs)(n.li,{children:["Sandbox \u2014 ",(0,r.jsx)(n.a,{href:"/docs/how-to/sandbox",children:"sandbox"})]}),"\n",(0,r.jsxs)(n.li,{children:["Engine \u2014 ",(0,r.jsx)(n.a,{href:"/docs/explanations/engine",children:"engine"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);