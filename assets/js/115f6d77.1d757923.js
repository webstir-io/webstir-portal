"use strict";(self.webpackChunkwebstir_portal=self.webpackChunkwebstir_portal||[]).push([[4792],{8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var i=s(6540);const r={},a=i.createContext(r);function t(e){const n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(a.Provider,{value:n},e.children)}},8470:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"product/plans/framework/package-release-automation","title":"Framework Package Release Automation Plan","description":"Status: historical reference. The automation has since moved to the registry-first workflow; details below describe the original migration plan.","source":"@site/docs/product/plans/framework/package-release-automation.md","sourceDirName":"product/plans/framework","slug":"/product/plans/framework/package-release-automation","permalink":"/docs/product/plans/framework/package-release-automation","draft":false,"unlisted":false,"editUrl":"https://github.com/webstir-io/webstir-portal/edit/main/docs/product/plans/framework/package-release-automation.md","tags":[],"version":"current","lastUpdatedAt":1761532142000,"frontMatter":{},"sidebar":"plans","previous":{"title":"Modular Refactor Plan","permalink":"/docs/product/plans/framework/modular-refactor"},"next":{"title":"Framework Packaging Plan","permalink":"/docs/product/plans/framework/packaging"}}');var r=s(4848),a=s(8453);const t={},l="Framework Package Release Automation Plan",o={},c=[{value:"Objectives",id:"objectives",level:2},{value:"Key Decisions",id:"key-decisions",level:2},{value:"Implementation Phases",id:"implementation-phases",level:2},{value:"Deliverables",id:"deliverables",level:2},{value:"Status",id:"status",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"framework-package-release-automation-plan",children:"Framework Package Release Automation Plan"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Status: historical reference. The automation has since moved to the registry-first workflow; details below describe the original migration plan."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"objectives",children:"Objectives"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Ship a single, intuitive CLI command that bumps versions, rebuilds tarballs, and publishes only the packages that changed\u2014no extra shell/Node scripts required."}),"\n",(0,r.jsxs)(n.li,{children:["Eliminate redundant metadata files/scripts so ",(0,r.jsx)(n.code,{children:"package.json"})," becomes the lone source of truth for package versions and registry specifiers."]}),"\n",(0,r.jsx)(n.li,{children:"Detect affected packages automatically and keep both local and CI workflows in sync."}),"\n",(0,r.jsxs)(n.li,{children:["Lay groundwork for future packages (e.g., ",(0,r.jsx)(n.code,{children:"@webstir-io/webstir-backend"}),") and optional replacements (such as third-party testing frameworks) without extra manual wiring."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"key-decisions",children:"Key Decisions"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Single entry point:"})," Introduce (or extend) ",(0,r.jsx)(n.code,{children:"framework packages"})," subcommands (",(0,r.jsx)(n.code,{children:"bump"}),", ",(0,r.jsx)(n.code,{children:"sync"}),", ",(0,r.jsx)(n.code,{children:"release"}),", ",(0,r.jsx)(n.code,{children:"publish"}),") so the CLI itself handles bump \u2192 build \u2192 publish with optional flags (",(0,r.jsx)(n.code,{children:"--package"}),", ",(0,r.jsx)(n.code,{children:"--all"}),", ",(0,r.jsx)(n.code,{children:"--dry-run"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Automated detection:"})," Determine which packages changed by inspecting git diff, manifest timestamps, or dependency graphs; default to only touching those packages."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Version strategy:"})," Derive bump level from commit metadata (labels or conventional commits). Allow manual override flags for edge cases."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Manifest authority:"})," Read/write package metadata directly in ",(0,r.jsx)(n.code,{children:"Framework/*/package.json"})," (and lockfiles). No additional catalog files."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Shared automation:"})," Reuse the same release command in CI (GitHub Actions) to avoid divergence between local and hosted workflows."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Failure handling & interactivity:"})," Default to fail-fast with clear remediation messages; support an opt-in ",(0,r.jsx)(n.code,{children:"--interactive"})," flag for prompt-driven local runs."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Release notes:"})," Auto-generate per-package notes grouped by conventional commit type, with a ",(0,r.jsx)(n.code,{children:"--no-notes"})," escape hatch."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Extensibility:"})," Allow alternative testing frameworks via configurable package entries and CLI commands (e.g., ",(0,r.jsx)(n.code,{children:"framework packages configure --testing <npm-package>"}),")."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"implementation-phases",children:"Implementation Phases"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Discovery & scaffolding"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Audit the current release flow (shell/Node helpers plus existing CLI commands) and document responsibilities that must migrate into the unified CLI."}),"\n",(0,r.jsx)(n.li,{children:"Design the unified CLI command surface and migration plan (parameters, dry-run support, UX expectations)."}),"\n",(0,r.jsxs)(n.li,{children:["Identify package metadata access points (",(0,r.jsx)(n.code,{children:"Framework/Packaging"}),", CLI) and draft a list of shared abstractions required (metadata service, process runner, git diff service)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Command foundation"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Implement reusable helpers inside the ",(0,r.jsx)(n.code,{children:"framework"})," console: a package metadata service (reads/writes manifests/lockfiles), a process runner abstraction (for npm/dotnet), and a repository diff service that shells out to ",(0,r.jsx)(n.code,{children:"git"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Extend ",(0,r.jsx)(n.code,{children:"framework packages"})," with first-class subcommands (",(0,r.jsx)(n.code,{children:"bump"}),", ",(0,r.jsx)(n.code,{children:"sync"}),", ",(0,r.jsx)(n.code,{children:"release"}),", ",(0,r.jsx)(n.code,{children:"publish"}),") plus shared option parsing (",(0,r.jsx)(n.code,{children:"--package"}),", ",(0,r.jsx)(n.code,{children:"--all"}),", ",(0,r.jsx)(n.code,{children:"--set-version"}),", ",(0,r.jsx)(n.code,{children:"--dry-run"}),")."]}),"\n",(0,r.jsx)(n.li,{children:"Establish consistent logging/exit codes for the new command infrastructure."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Automation logic"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Implement change detection using the new repository diff service (e.g., ",(0,r.jsx)(n.code,{children:"git diff --name-only"}),") to pick targeted packages automatically."]}),"\n",(0,r.jsx)(n.li,{children:"Wire in version bump heuristics (labels or commit messages) with override flags."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Ensure tarball rebuilds (package manager install + build/pack; ",(0,r.jsx)(n.code,{children:"pnpm install"})," by default) execute only for selected packages via the process runner abstraction.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Track per-package release results (bumped version, tarball path, publish status) for downstream reporting."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Publish integration"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Handle npm auth detection (",(0,r.jsx)(n.code,{children:"GH_PACKAGES_TOKEN"}),", ",(0,r.jsx)(n.code,{children:".npmrc"}),") once per run with clear remediation messages."]}),"\n",(0,r.jsx)(n.li,{children:"Publish each touched package conditionally; gather results into a single summary."}),"\n",(0,r.jsx)(n.li,{children:"Update release notes/changelog snippets per package where possible."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Tool & workflow cleanup"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Remove the existing shell/Node scripts as soon as their responsibilities land in the CLI\u2014no legacy compatibility required."}),"\n",(0,r.jsxs)(n.li,{children:["Update ",(0,r.jsx)(n.code,{children:"format-build.sh"}),", CI workflows, and documentation to reference the new CLI-only flow."]}),"\n",(0,r.jsx)(n.li,{children:"Provide guidance for adding new packages (manifest structure, naming conventions, build hooks)."}),"\n",(0,r.jsx)(n.li,{children:"Stub the backend package entry (directory, manifest, disabled flag) so the new tooling handles future packages from day one."}),"\n",(0,r.jsx)(n.li,{children:"Prune or refactor tests that exercised the legacy scripts; replace them with coverage for the new CLI subcommands."}),"\n",(0,r.jsxs)(n.li,{children:["Detailed workstream: ",(0,r.jsx)(n.code,{children:"Docs/product/plans/framework/package-release-automation-phase5.md"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Testing & rollout"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Add unit/integration coverage for the new helper functions and CLI command variants."}),"\n",(0,r.jsx)(n.li,{children:"Run end-to-end smoke tests: single package change, multiple package change, no-op release, missing credentials."}),"\n",(0,r.jsx)(n.li,{children:"Pilot the command internally before switching CI/release workflows."}),"\n",(0,r.jsx)(n.li,{children:"Track remaining migration tasks (script removal PRs, doc updates) to ensure nothing lingers post-cutover."}),"\n",(0,r.jsxs)(n.li,{children:["Detailed workstream: ",(0,r.jsx)(n.code,{children:"Docs/product/plans/framework/package-release-automation-phase6.md"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"deliverables",children:"Deliverables"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Updated ",(0,r.jsx)(n.code,{children:"framework"})," console with per-package release capabilities and automation logic baked into the CLI."]}),"\n",(0,r.jsx)(n.li,{children:"Documentation refresh (quick start, package maintenance guides, CI instructions)."}),"\n",(0,r.jsx)(n.li,{children:"Migration notes covering removal of old scripts and how to adopt the new command."}),"\n",(0,r.jsx)(n.li,{children:"Optional templates for future packages (backend) or community extensions."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"status",children:"Status"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Key design decisions above resolve previous open questions; remaining work is tracked in the implementation phases."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);