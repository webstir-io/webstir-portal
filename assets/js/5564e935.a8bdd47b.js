"use strict";(self.webpackChunkwebstir_portal=self.webpackChunkwebstir_portal||[]).push([[7933],{6137:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"how-to/frontend-watch","title":"Frontend Watch Daemon","description":"Guidance for running and troubleshooting the incremental frontend watch workflow.","source":"@site/docs/how-to/frontend-watch.md","sourceDirName":"how-to","slug":"/how-to/frontend-watch","permalink":"/docs/how-to/frontend-watch","draft":false,"unlisted":false,"editUrl":"https://github.com/webstir-io/webstir-portal/edit/main/docs/how-to/frontend-watch.md","tags":[],"version":"current","lastUpdatedAt":1764454564000,"frontMatter":{},"sidebar":"howTo","previous":{"title":"Build Framework Packages","permalink":"/docs/how-to/framework-packages"},"next":{"title":"HMR Validation Checklist","permalink":"/docs/how-to/hmr-validation"}}');var s=r(4848),t=r(8453);const l={},i="Frontend Watch Daemon",d={},a=[{value:"Overview",id:"overview",level:2},{value:"CLI Commands",id:"cli-commands",level:2},{value:"Verbose Logging",id:"verbose-logging",level:2},{value:"Failure Recovery",id:"failure-recovery",level:2},{value:"Fallbacks",id:"fallbacks",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"frontend-watch-daemon",children:"Frontend Watch Daemon"})}),"\n",(0,s.jsx)(n.p,{children:"Guidance for running and troubleshooting the incremental frontend watch workflow."}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"webstir watch"})," launches the daemon and streams rebuild results to the .NET CLI runtime."]}),"\n",(0,s.jsx)(n.li,{children:"The browser badge reflects build state: orange for in-progress, green for success, red for errors, and red/gray when disconnected."}),"\n",(0,s.jsx)(n.li,{children:"Reload events are debounced so rapid edits coalesce into a single browser refresh."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"cli-commands",children:"CLI Commands"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Default workflow: ",(0,s.jsx)(n.code,{children:"webstir watch"})]}),"\n",(0,s.jsxs)(n.li,{children:["Manual daemon: ",(0,s.jsx)(n.code,{children:"npx webstir-frontend watch-daemon --workspace <absolute-path>"})]}),"\n",(0,s.jsxs)(n.li,{children:["Defer auto-start for manual control: add ",(0,s.jsx)(n.code,{children:"--no-auto-start"})]}),"\n",(0,s.jsxs)(n.li,{children:["Enable verbose diagnostics: add ",(0,s.jsx)(n.code,{children:"--verbose"})]}),"\n",(0,s.jsxs)(n.li,{children:["Focus on hot-update diagnostics: add ",(0,s.jsx)(n.code,{children:"--hmr-verbose"})]}),"\n",(0,s.jsxs)(n.li,{children:["Send a manual change event (stdin JSON): ",(0,s.jsx)(n.code,{children:'{"type":"change","path":"/absolute/path/to/file"}'})]}),"\n",(0,s.jsxs)(n.li,{children:["Request a manual reload: ",(0,s.jsx)(n.code,{children:'{"type":"reload"}'})]}),"\n",(0,s.jsxs)(n.li,{children:["Shutdown the daemon cleanly: ",(0,s.jsx)(n.code,{children:'{"type":"shutdown"}'})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"verbose-logging",children:"Verbose Logging"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Toggle verbose mode temporarily with the CLI flag (",(0,s.jsx)(n.code,{children:"--verbose"}),") or set ",(0,s.jsx)(n.code,{children:"WEBSTIR_FRONTEND_WATCH_VERBOSE=1"})," before running ",(0,s.jsx)(n.code,{children:"webstir watch"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Surface hot-update counters and fallback reasons with ",(0,s.jsx)(n.code,{children:"--hmr-verbose"})," or the ",(0,s.jsx)(n.code,{children:"WEBSTIR_FRONTEND_HMR_VERBOSE=1"})," environment variable."]}),"\n",(0,s.jsx)(n.li,{children:"Verbose mode surfaces detailed diagnostics (builder timings, esbuild stats, context churn); default mode keeps logs quiet."}),"\n",(0,s.jsx)(n.li,{children:"HMR verbose mode emits per-update module/style lists, cumulative hot-update vs. reload totals, and fallback reasons when a reload is required."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"failure-recovery",children:"Failure Recovery"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Restart the daemon: stop ",(0,s.jsx)(n.code,{children:"webstir watch"})," with ",(0,s.jsx)(n.code,{children:"Enter"}),", then run it again."]}),"\n",(0,s.jsxs)(n.li,{children:["If lockfiles drift, delete the lockfile and re-run your package manager (",(0,s.jsx)(n.code,{children:"pnpm install"})," by default); the watch workflow also falls back automatically when the install step fails."]}),"\n",(0,s.jsxs)(n.li,{children:["Bypass the daemon with ",(0,s.jsx)(n.code,{children:"npx webstir-frontend build --workspace <absolute-path>"})," for one-off builds."]}),"\n",(0,s.jsxs)(n.li,{children:["When the badge stays red, inspect the last ",(0,s.jsx)(n.code,{children:"frontend.watch"})," error and re-run with verbose logging if needed."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"fallbacks",children:"Fallbacks"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["You can revert to the previous per-invocation CLI flow by running ",(0,s.jsx)(n.code,{children:"webstir-frontend build"}),"/",(0,s.jsx)(n.code,{children:"rebuild"})," manually."]}),"\n",(0,s.jsxs)(n.li,{children:["Clearing ",(0,s.jsx)(n.code,{children:"build/frontend"})," and ",(0,s.jsx)(n.code,{children:"dist/frontend"})," is safe; the daemon will repopulate outputs on the next rebuild."]}),"\n",(0,s.jsxs)(n.li,{children:["Hot-update stats are included in ",(0,s.jsx)(n.code,{children:"frontend.watch.pipeline.success"})," diagnostics and browser console logs so you can confirm fallbacks stay rare (below 10%)."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>i});var o=r(6540);const s={},t=o.createContext(s);function l(e){const n=o.useContext(t);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);