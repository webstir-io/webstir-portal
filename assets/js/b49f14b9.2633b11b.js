"use strict";(self.webpackChunkwebstir_portal=self.webpackChunkwebstir_portal||[]).push([[5364],{1378:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"explanations/solution","title":"Solution","description":"Hub for the CLI and host tooling. This doc explains what the solution is, how it\u2019s organized, the technology choices, and how the app works at a high level.","source":"@site/docs/explanations/solution.md","sourceDirName":"explanations","slug":"/explanations/solution","permalink":"/docs/explanations/solution","draft":false,"unlisted":false,"editUrl":"https://github.com/webstir-io/webstir-portal/edit/main/docs/explanations/solution.md","tags":[],"version":"current","lastUpdatedAt":1764454564000,"frontMatter":{},"sidebar":"explanations","previous":{"title":"Services","permalink":"/docs/explanations/services"},"next":{"title":"Testing","permalink":"/docs/explanations/testing"}}');var r=s(4848),l=s(8453);const d={},c="Solution",o={},t=[{value:"What It Is",id:"what-it-is",level:2},{value:"Organization",id:"organization",level:2},{value:"Technology",id:"technology",level:2},{value:"How It Works",id:"how-it-works",level:2},{value:"Conventions &amp; Structure",id:"conventions--structure",level:2},{value:"CLI Summary",id:"cli-summary",level:2},{value:"Related Docs",id:"related-docs",level:2},{value:"Scope &amp; Non-Goals",id:"scope--non-goals",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"solution",children:"Solution"})}),"\n",(0,r.jsx)(n.p,{children:"Hub for the CLI and host tooling. This doc explains what the solution is, how it\u2019s organized, the technology choices, and how the app works at a high level."}),"\n",(0,r.jsx)(n.h2,{id:"what-it-is",children:"What It Is"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Opinionated, zero-config build tool and project scaffolder."}),"\n",(0,r.jsx)(n.li,{children:"Full-stack by default: frontend (HTML/CSS/TS) + Node API server."}),"\n",(0,r.jsx)(n.li,{children:"Single CLI drives workflows: init, build, watch, test, publish, generators."}),"\n",(0,r.jsx)(n.li,{children:"Minimal dependencies; pipelines are orchestrated via C# and pnpm is the default package manager for generated workspaces."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"organization",children:"Organization"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/reference/cli",children:"CLI"}),": Command entrypoint and help text. Wires DI and invokes workflows."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/explanations/engine",children:"Engine"}),": Core logic and pipelines.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/reference/workflows",children:"Workflows"}),": Orchestrations for init, build, watch, test, publish, add-page, add-test."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/explanations/engine#workers",children:"Workers"}),": Per-area units: FrontendWorker, BackendWorker, SharedWorker."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/explanations/pipelines",children:"Pipelines"}),": HTML, CSS, JS compilers/bundlers and diagnostics."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/explanations/services",children:"Services"}),": DevService, WatchService, ChangeService."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/explanations/servers",children:"Servers"}),": Static web server (ASP.NET Core) + Node API host."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/reference/templates",children:"Templates"}),": Embedded project template (frontend/backend/shared/types)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/explanations/workspace",children:"Workspace"}),": Centralized paths and workspace utilities."]}),"\n",(0,r.jsxs)(n.li,{children:["Worker contracts & DI: ",(0,r.jsx)(n.code,{children:"IWorkflowWorker"})," (common) and ",(0,r.jsx)(n.code,{children:"IFrontendWorker"})," (adds ",(0,r.jsx)(n.code,{children:"AddPageAsync"}),"). DI registers all workers as ",(0,r.jsx)(n.code,{children:"IWorkflowWorker"}),"; workflows inject ",(0,r.jsx)(n.code,{children:"IEnumerable<IWorkflowWorker>"})," and filter by project mode."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/explanations/testing",children:"Tester"}),": xUnit harness validating CLI workflows end-to-end."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/how-to/sandbox",children:"Sandbox"}),": Docker Compose setup to run a published frontend (nginx) and the template API server."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/how-to/utilities",children:"Utilities"}),": Repo helper scripts (",(0,r.jsx)(n.code,{children:"utilities/scripts/*"})," for format, build, seed deploy)."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"technology",children:"Technology"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Language/Runtime: C# (.NET 9 for CLI), TypeScript for template code."}),"\n",(0,r.jsxs)(n.li,{children:["Dev Web Server: ASP.NET Core minimal app serves ",(0,r.jsx)(n.code,{children:"build/"})," with SSE for reload."]}),"\n",(0,r.jsxs)(n.li,{children:["API Server: Node.js runs compiled ",(0,r.jsx)(n.code,{children:"src/backend/index.ts"})," (via ",(0,r.jsx)(n.code,{children:"tsc"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Build System: Custom C# pipelines for HTML, CSS, JS.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["TypeScript: ",(0,r.jsx)(n.code,{children:"tsc --build"})," using embedded ",(0,r.jsx)(n.code,{children:"base.tsconfig.json"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"CSS: Import resolution, optional CSS Modules in publish, prefixing, minify."}),"\n",(0,r.jsx)(n.li,{children:"JS: ESM-only module graph, tree-shake + minify in publish."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Change Detection: ",(0,r.jsx)(n.code,{children:"FileSystemWatcher"})," + buffered change queue; restarts API server on server code changes; notifies browser via SSE."]}),"\n",(0,r.jsxs)(n.li,{children:["Caching/URLs: Clean URLs, API proxy (",(0,r.jsx)(n.code,{children:"/api/*"})," \u2192 Node), cache headers for dev/prod."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Init (",(0,r.jsx)(n.code,{children:"webstir init [options] [directory]"}),")","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Creates a full-stack project (or frontend/backend-only) from embedded templates."}),"\n",(0,r.jsxs)(n.li,{children:["Layout: ",(0,r.jsx)(n.code,{children:"src/frontend/app"}),", ",(0,r.jsx)(n.code,{children:"src/frontend/pages/<page>"}),", ",(0,r.jsx)(n.code,{children:"src/backend"}),", ",(0,r.jsx)(n.code,{children:"src/shared"}),", ",(0,r.jsx)(n.code,{children:"types/"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Build (",(0,r.jsx)(n.code,{children:"webstir build"}),")","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Compiles TS, processes CSS imports, merges page HTML with ",(0,r.jsx)(n.code,{children:"app.html"})," into ",(0,r.jsx)(n.code,{children:"build/"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Watch (",(0,r.jsx)(n.code,{children:"webstir watch"}),") \u2014 default","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Runs an initial build and tests, starts the web server and Node API server, then watches ",(0,r.jsx)(n.code,{children:"src/**"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"On change: incrementally rebuilds the affected area, restarts Node for backend changes, and signals browsers to reload via SSE."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Test (",(0,r.jsx)(n.code,{children:"webstir test"}),")"]}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Builds, ensures the configured test provider (defaults to ",(0,r.jsx)(n.code,{children:"@webstir-io/webstir-testing"}),") is installed, then executes the Webstir test host to run compiled frontend and backend suites; reports pass/fail summary."]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsxs)(n.li,{children:["Publish (",(0,r.jsx)(n.code,{children:"webstir publish"}),")","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Produces optimized assets in ",(0,r.jsx)(n.code,{children:"dist/"})," per page: timestamped ",(0,r.jsx)(n.code,{children:"index.<ts>.css/js"})," written alongside ",(0,r.jsx)(n.code,{children:"manifest.json"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"HTML is minified and references are rewritten using the per-page manifest; source maps and comments are removed."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Generators","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"webstir add-page <name>"})," scaffolds ",(0,r.jsx)(n.code,{children:"index.html|css|ts"})," under ",(0,r.jsx)(n.code,{children:"src/frontend/pages/<name>/"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"webstir add-test <name-or-path>"})," scaffolds a ",(0,r.jsx)(n.code,{children:".test.ts"})," under the closest ",(0,r.jsx)(n.code,{children:"tests/"})," folder."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"conventions--structure",children:"Conventions & Structure"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Base HTML: ",(0,r.jsx)(n.code,{children:"src/frontend/app/app.html"})," must contain a ",(0,r.jsx)(n.code,{children:"<main>"}),"; page fragments merge into it."]}),"\n",(0,r.jsxs)(n.li,{children:["Pages: ",(0,r.jsx)(n.code,{children:"src/frontend/pages/<page>/index.html|css|ts"})," (publish supports ",(0,r.jsx)(n.code,{children:"<page>/index.module.css"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["App assets: ",(0,r.jsx)(n.code,{children:"src/frontend/app/*"})," copied as-is (e.g., ",(0,r.jsx)(n.code,{children:"refresh.js"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Shared types: ",(0,r.jsx)(n.code,{children:"src/shared/"})," (consumed by both frontend and backend)."]}),"\n",(0,r.jsxs)(n.li,{children:["Backend: ",(0,r.jsx)(n.code,{children:"src/backend/index.ts"})," compiled to ",(0,r.jsx)(n.code,{children:"build/backend/index.js"})," and run by Node."]}),"\n",(0,r.jsxs)(n.li,{children:["Outputs:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Dev: ",(0,r.jsx)(n.code,{children:"build/frontend/**"}),", ",(0,r.jsx)(n.code,{children:"build/backend/**"})," with readable output and refresh support."]}),"\n",(0,r.jsxs)(n.li,{children:["Prod: ",(0,r.jsx)(n.code,{children:"dist/frontend/pages/<page>/index.<timestamp>.{css|js}"}),", HTML with rewritten links, per-page ",(0,r.jsx)(n.code,{children:"manifest.json"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"cli-summary",children:"CLI Summary"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"init [--client-only|--server-only] [--project-name|-p <name>] [directory]"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"build [--clean]"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"watch"})," (alias: no command)"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"test"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"publish"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"add-page <name>"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"add-test <name-or-path>"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"help [command]"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["See also: ",(0,r.jsx)(n.a,{href:"/docs/reference/cli",children:"CLI reference"})]}),"\n",(0,r.jsx)(n.h2,{id:"related-docs",children:"Related Docs"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Docs index \u2014 ",(0,r.jsx)(n.a,{href:"/docs/",children:"overview"})]}),"\n",(0,r.jsxs)(n.li,{children:["Templates \u2014 ",(0,r.jsx)(n.a,{href:"/docs/reference/templates",children:"templates"})]}),"\n",(0,r.jsxs)(n.li,{children:["Testing \u2014 ",(0,r.jsx)(n.a,{href:"/docs/explanations/testing",children:"tests"})," and ",(0,r.jsx)(n.a,{href:"https://github.com/webstir-io/webstir-dotnet/blob/main/.codex/testing.md",children:"orchestrator testing guide"})]}),"\n",(0,r.jsxs)(n.li,{children:["Workspace & paths \u2014 ",(0,r.jsx)(n.a,{href:"/docs/explanations/workspace",children:"workspace"})]}),"\n",(0,r.jsxs)(n.li,{children:["CLI reference \u2014 ",(0,r.jsx)(n.a,{href:"/docs/reference/cli",children:"cli reference"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"scope--non-goals",children:"Scope & Non-Goals"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Keep defaults simple and predictable; prefer conventions over configuration."}),"\n",(0,r.jsx)(n.li,{children:"Avoid complex plugin systems and heavy third-party build chains."}),"\n",(0,r.jsx)(n.li,{children:"Focus on end-to-end workflows (init \u2192 build \u2192 watch/test \u2192 publish)."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>c});var i=s(6540);const r={},l=i.createContext(r);function d(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);